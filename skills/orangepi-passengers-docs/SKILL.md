---
name: orangepi-passengers-docs
description: Documentation maintenance and auto-reporting workflow for the OrangePi_passangers project. Use when asked to “update docs”, “write down what we did”, categorize modules/actions/problems, keep door mapping (door_id ↔ hostname ↔ IP) consistent, or generate/refresh Docs/auto reports (baseline, inventory) before continuing configuration.
---

# OrangePi Passengers Docs

## Workflow

### 1) Start from canon (doors)

Do not rename/repurpose terms silently. Always reference/update the canon first:

- `Docs/настройка ПО/План/0. Паспорт дверей (door_id ↔ hostname ↔ IP).md`

If a mapping changes, update the canon and then fix references across docs.

For scale (100–200 systems), also keep these in sync:

- `fleet/registry.csv`
- `Docs/настройка ПО/План/11. Масштабирование 100-200 систем (реестр и шаблоны).md`
- `fleet/out/<SYSTEM_ID>/commands.md` generated by `scripts/fleet_registry.py bundle`

Scale rule:

- one transport = one `system_id` + one WG peer + one `central_id`;
- `central_id` must match `system_id` (example: `sys-0008`) for correct overrides/incidents/alerts.

### 2) Capture reality (auto reports)

Before writing “what we did”, generate fresh reports:

```bash
python3 scripts/opizero_baseline.py --host 192.168.10.1 --user orangepi
python3 scripts/opizero_inventory.py --user orangepi 192.168.10.1 192.168.10.11 192.168.10.12
```

Use as ground truth:

- `Docs/auto/baseline-summary.md`
- `Docs/auto/inventory/INDEX.md`

### 3) Update docs by category

Primary index:

- `Docs/Проект/INDEX.md`
- `Docs/Проект/Документация (архитектура и правила).md`

Update the right category:

- Modules: `Docs/Проект/Модули.md`
- Actions/operations: `Docs/Проект/Операции.md`
- Problems/troubleshooting: `Docs/Проект/Проблемы.md`

Rule: keep each doc “one job”. If a section grows too large, split into a new file and link it from `Docs/Проект/INDEX.md`.

### 4) Keep references correct

- Prefer linking to canonical files instead of duplicating tables.
- Avoid ambiguous “Door-1” wording; always specify whether it’s hostname (`door-1`) or physical door number (дверь №… / `door_id`).
- When documenting rollout for new transport, reference generated bundle in `fleet/out/<SYSTEM_ID>/`.

## Mandatory Stage Rule

- After every code/config change, update docs in the same iteration (module/operations/problems/index as needed).
- Every stage summary must explicitly contain: next step and why it is needed.
