# Web panel v2 pack02 (2026-02-23): Fleet real-data (HTMX)

## Цель

- Начать миграцию доменов v2 с самого ценного: `Флот`.
- Дать “первый реальный экран” без SPA: данные из sqlite, авто-обновление через HTMX.
- Зафиксировать базовые v2 компоненты для KPI и таблиц (Core CSS).

## Изменения (v2)

- `backend/app/webpanel_v2/domains/admin/fleet.py`
  - `/admin2/fleet` теперь реальная страница (не placeholder).
  - `/admin2/_fragment/fleet/monitor` отдаёт HTML фрагмент:
    - KPI: centrals (bad/warn/pending)
    - KPI: incidents (bad/warn)
    - таблица centrals (top-N), сортировка: bad -> warn -> good
- `backend/app/webpanel_v2/templates/admin/fleet.html`
- `backend/app/webpanel_v2/templates/admin/fragments/fleet_monitor.html`
- `backend/app/webpanel_v2/static/v2.css`
  - добавлены `v2Kpi*`, `v2Pill*`, `v2Table*`, `v2Loading` (htmx-indicator)
- `backend/app/webpanel_v2/__init__.py`: bump `UI_BUILD` -> `2026-02-23-v2-pack02`.

## Проверка

- `/admin2/fleet` = 200
- `/admin2/_fragment/fleet/monitor` = 200 (HTMX)
- `data-ui-build="2026-02-23-v2-pack02"` на v2 страницах.

## Артефакты

- Скриншоты: `Docs/auto/web-panel/screenshots/2026-02-23-v2-pack02/`

## VPS deploy (server-first)

```bash
rsync -av --delete --exclude '__pycache__/' --exclude '*.pyc' \
  backend/app/webpanel_v2/ alis@207.180.213.225:/opt/passengers-backend/app/webpanel_v2/

rsync -av backend/app/main.py alis@207.180.213.225:/opt/passengers-backend/app/main.py

ssh -4 alis@207.180.213.225 '
  cd /opt/passengers-backend &&
  python3 -m py_compile app/webpanel_v2/domains/admin/fleet.py app/webpanel_v2/core/render.py &&
  sudo docker compose -f compose.yaml -f compose.server.yaml up -d --build api
'
```
