# Web panel v2 pack01 (2026-02-23)

## Цель

- Принять структуру `Core + Domains` для v2 (Jinja2 + HTMX), чтобы v2 не жил “в одном файле”.
- Разнести роуты v2 из `backend/app/main.py` в модульные роутеры.
- Зафиксировать IA меню (2 уровня) под канон admin/client и подготовить placeholders под миграцию доменов.

## Изменения (код)

- `backend/app/webpanel_v2/core/*`:
  - `render.py` (shell + inline assets)
  - `nav.py` (IA, active/open state)
  - `fragments.py` (time/ping HTMX fragments)
- `backend/app/webpanel_v2/domains/*`:
  - `admin/*` (Старт/Флот/Сповіщення/Контроль і KPI/Інфраструктура)
  - `client/*` (Огляд/Транспорт і статуси/Акаунт)
- `backend/app/webpanel_v2/router.py`: сборка роутеров v2.
- `backend/app/main.py`: подключение v2 через `app.include_router(...)` (без inline v2 routes).
- `backend/app/webpanel_v2/__init__.py`: bump `UI_BUILD`.

## Изменения (доки)

- `Docs/Проект/Веб-панель/Ядро (Core).md`: добавлен раздел про v2 модули.
- `Docs/Проект/Веб-панель/Архитектура меню (admin+client).md`: добавлены v2 маршруты рядом с v1.

## VPS deploy (server-first)

Критично: backend контейнер собирается с `COPY app ./app`, поэтому нужен rebuild:

```bash
rsync -av --delete --exclude '__pycache__/' --exclude '*.pyc' \
  backend/app/webpanel_v2/ alis@207.180.213.225:/opt/passengers-backend/app/webpanel_v2/

rsync -av backend/app/main.py alis@207.180.213.225:/opt/passengers-backend/app/main.py

ssh -4 alis@207.180.213.225 '
  cd /opt/passengers-backend &&
  python3 -m py_compile app/main.py app/webpanel_v2/router.py &&
  sudo docker compose -f compose.yaml -f compose.server.yaml up -d --build api
'
```

## Проверка

- `GET /admin2` и `/admin2/` => `200`, `data-ui-build="2026-02-23-v2-pack01"`.
- `GET /client2` и `/client2/` => `200`, `data-ui-build="2026-02-23-v2-pack01"`.
