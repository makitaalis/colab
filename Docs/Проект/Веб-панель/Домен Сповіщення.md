# Домен Сповіщення

## Назначение

Управление правилами уведомлений и операционным контуром доставки.

## Route scope

- `/admin/fleet/notifications`
- `/admin/fleet/notify-center`

## API scope

- `/api/admin/fleet/notification-settings`
- `/api/admin/fleet/notification-settings/test`
- `/api/admin/fleet/notifications/retry`
- `/api/admin/fleet/incidents/notifications`

## UX-контракт домена

1. Разделение двух сценариев:
- правила каналов;
- доставка/ретраи.
2. На каждой странице видны:
- статус канала;
- окно данных;
- следующий операторский шаг.

## Ограничения

- не смешивать policy override и delivery журнал в одном блоке;
- сложные triage-блоки не в этом домене.

## Definition of Done

1. Для обеих страниц есть `copyLink` и `filterSummary`.
2. Retry/test действия дают прозрачный статус (ok/error/dry-run).
3. Доставка не блокирует UI при сетевых ошибках.

## Прогресс content-split (2026-02-16)

- `/admin/fleet/notify-center` разгружен по сценарию:
  - primary: `Оперативний огляд доставки` (ключевые агрегаты sent/failed/skipped/retryable);
  - secondary: детальный delivery-журнал и retry-операции в сворачиваемом блоке `Журнал доставки та помилки`.
- Состояние secondary-блока сохраняется локально:
  - key: `passengers_admin_notify_secondary_details_v1`.
- UX-эффект:
  - оператор сначала видит короткий контур риска и навигацию по домену;
  - детальный поток доставок открывается по запросу без перегрузки первого экрана.

## Прогресс visual polish (2026-02-17)

- `/admin/fleet/notify-center` доведен по правилам visual-density:
  - updated-at контекст в header chips;
  - фильтры вынесены в `toolbarDetails` (advanced);
  - secondary журнал помечен `data-advanced-details="1"` для Simple-mode;
  - table без лишней вложенной card.

- `/admin/fleet/notifications` доведен по visual-density:
  - добавлен `tableMeta` для блока правил (`/api/admin/fleet/notification-settings`);
  - тестовая доставка вынесена в secondary `<details>` (persistent):
    - key: `passengers_admin_notifications_secondary_details_v1`.
