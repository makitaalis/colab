# Архитектура

## Узлы

Сводная карта (канон): `Docs/настройка ПО/План/0. Паспорт дверей (door_id ↔ hostname ↔ IP).md`.

- `central-gw` (4GB, дверь №1): камера OAK‑D Lite, подсчёт по двери №1, сбор/агрегация событий от edge‑узлов, мастер времени, отправка наружу по Wi‑Fi и/или LTE.
- `door-1` (1GB, дверь №2): камера OAK‑D Lite, edge‑подсчёт, локальный буфер, доставка на Central по Ethernet.
- `door-2` (1GB, дверь №3): камера OAK‑D Lite, edge‑подсчёт, локальный буфер, доставка на Central по Ethernet.

## Сеть

- LAN: `192.168.10.0/24`, без DHCP, без gateway на `end0`.
- Статические IP по `NetworkManager` профилю `opizero3-static`.
- `nftables` включён; входящие ограничены.

Передача данных:

- edge → central: Ethernet (внутренняя LAN)
- central → интернет: Wi‑Fi и/или GSM/LTE (EM7455)

## Время

Критично для корректных `timestamp`/агрегации.

- Central: RTC-first + локальный NTP (chrony) + ручная калибровка от GPS при необходимости.
- Door узлы: NTP client only от Central + барьер запуска pipeline до синхронизации.

Док: `Docs/настройка ПО/План/3. Синхронизация времени (критично для данных).md`.
